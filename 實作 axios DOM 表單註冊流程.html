<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>實作 axios DOM 表單註冊流程</title>
</head>
<body>
    <div id = "form">
        <h2>註冊</h2>
        <label>帳號：</label>
        <input type="email" id="account">
        <br>
        <label>密碼：</label>
        <input type = "password" id = "pw">
        <button id = "view">顯示密碼</button>
        <br>
        <button id = "submit">註冊</button>
        <label id="message"></label>
    </div>
    <hr>
    <div id = "form2">
        <h2>登入</h2>
        <label>帳號：</label>
        <input type="email" id="account2">
        <br>
        <label>密碼：</label>
        <input type = "password" id = "pw2">
        <button id = "view2">顯示密碼</button>
        <br>
        <button id = "submit2">登入</button>
        <label id="message2"></label>
    </div>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    //註冊
    let acc = document.querySelector("#account");
    let pw = document.querySelector("#pw");
    let sbmt = document.querySelector("#submit");
    let mss = document.querySelector("#message");
    let viewPw = document.querySelector("#view");

    //顯示密碼
    viewPw.addEventListener("mousedown", function(e){
        pw.setAttribute("type", "text");
    });
    viewPw.addEventListener("mouseup", function(e){
        pw.setAttribute("type", "password");
    });

    //https://hexschool-tutorial.herokuapp.com/api/signup
    sbmt.addEventListener("click",function(e){

        if(acc.value.trim() === "" || pw.value.trim() === ""){
            alert("帳號或密碼有空!");
            return;
        }

        let obj = {};
        obj.email = acc.value;
        obj.password = pw.value;
        axios.post("https://hexschool-tutorial.herokuapp.com/api/signup", obj)
        .then(function(response){
            alert(response.data["message"]);
            acc.value = '';
            pw.value = "";
        })
        .catch(function(error){
            mss.textContent = error.message;
        });
    });


    //登入
    let acc2 = document.querySelector("#account2");
    let pw2 = document.querySelector("#pw2");
    let sbmt2 = document.querySelector("#submit2");
    let mss2 = document.querySelector("#message2");
    let viewPw2 = document.querySelector("#view2");

    //顯示密碼
    viewPw2.addEventListener("mousedown", function(e){
        pw2.setAttribute("type", "text");
    });
    viewPw2.addEventListener("mouseup", function(e){
        pw2.setAttribute("type", "password");
    });

    //https://hexschool-tutorial.herokuapp.com/api/signin
    sbmt2.addEventListener("click",function(e){

        if(acc2.value.trim() === "" || pw2.value.trim() === ""){
            alert("帳號或密碼有空!");
            return;
        }
        let obj2 = {};
        obj2.email = acc2.value;
        obj2.password = pw2.value;
        axios.post("https://hexschool-tutorial.herokuapp.com/api/signin",obj2)
        .then(function(response){
            alert(response.data["message"]);
            acc2.value = '';
            pw2.value = "";
        })
        .catch(function(error){
            mss2.textContent = error.message;
        });
    });
    

</script>
</body>
</html>